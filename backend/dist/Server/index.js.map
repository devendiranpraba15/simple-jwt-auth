{"version":3,"file":"index.js","names":["_express","_interopRequireDefault","require","_dotenv","_sequelize","_Middleware","_envConfig","dotenv","config","debug","path","app","express","PORT","getEnv","handle404","req","res","status","json","error","message","handle500","err","next","console","initServer","handlers","set","use","appMiddleware","sequelizeConnector","msg","forEach","handler","router","listen","log","e","process","on","exit","_default","exports"],"sources":["../../src/Server/index.js"],"sourcesContent":["import express from 'express';\r\nimport dotenv from 'dotenv';\r\nimport sequelizeConnector from '../Utils/DbConnector/sequelize';\r\nimport appMiddleware from '../Middleware';\r\nimport { getEnv } from '../Utils/envConfig';\r\n\r\ndotenv.config({ debug: true, path: './src/_settings.env' });\r\nconst app = express();\r\n\r\nconst PORT = getEnv('apiServerPort');\r\n\r\nconst handle404 = (req, res) => {\r\n  res.status(404).json({ error: 'Not Found', message: 'Invalid API Endpoint' });\r\n};\r\n\r\nconst handle500 = (err, req, res, next) => {\r\n  console.error('Internal Server Error:', err);\r\n  res.status(500).json({ error: 'Internal Server Error', message: 'Something went wrong' });\r\n};\r\n\r\nconst initServer = (handlers) => {\r\n  app.set('serverStarted', false);\r\n  app.set('dbConnected', false);\r\n  app.use(appMiddleware);\r\n\r\n  sequelizeConnector((status, msg) => {\r\n    if (status === 'SUCCESS') {\r\n      app.set('dbConnected', true);\r\n    } else app.set('dbConnected', false);\r\n  });\r\n\r\n  handlers.forEach((handler) => {\r\n    app.use(handler.path, handler.router);\r\n  });\r\n\r\n  try {\r\n    app.use(handle404);\r\n    app.use(handle500);\r\n    app.listen(PORT, () => {\r\n      console.log('Server started on port ' + PORT + '...!');\r\n    });\r\n  } catch (e) {\r\n    console.log('Error occurred while starting API server', e);\r\n  }\r\n  app.set('serverStarted', true);\r\n\r\n  process.on('SIGINT', () => {\r\n    console.log('SIGINT: Terminating API server...');\r\n    process.exit(1);\r\n  });\r\n  app.on('close', () => {\r\n    console.log('Server has closed');\r\n  });\r\n\r\n  return app;\r\n};\r\n\r\nexport default initServer;\r\n"],"mappings":"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","ignoreList":[]}